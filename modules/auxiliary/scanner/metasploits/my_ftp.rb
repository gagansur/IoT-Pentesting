require '/lib/msf/core/exploit/ftp.rb'
require '/lib/msf/core/auxiliary/scanner.rb'
require '/lib/msf/core/auxiliary/report.rb'

class MetasploitModule < Msf::Auxiliary
  include Msf::Exploit::Remote::Ftp
  include Msf::Auxiliary::Scanner
  include Msf::Auxiliary::Report
  def initialize
    super(
      'Name'        => 'Ginni FTP customized module',
      'Description' => 'Detect FTP Version from the target',
      'Author'      => 'Ginni Sur',
      'License'     => MSF_LICENSE
      )

      register_options(
      [
        Opt::RPORT(21),
      ])
  end
  
  def run_host(target_host)
    connect(true, false)
    if(banner)
      print_status("#{rhost} is running #{banner}")
      report_service(:host => rhost, :port => rport, :name => "ftp", :info => banner)
    else
      print_status("#{rhost} fails to run #{banner}")
    end
    disconnect
  end
end
