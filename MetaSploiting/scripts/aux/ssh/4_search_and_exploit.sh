#!/bin/bash
#run search ssh on msfconsole using heredocs and /bin/bash
#heredoc can be used to write multiple commands that will be run in 
#/bin/bash using sudo
sudo /bin/bash <<begin_to_end
msfconsole -q -x "search ssh">data/search_ssh.txt
begin_to_end

#read vulnerabilities from search_ssh.txt file and get the second column
vulnerabilities=$(awk 'BEGIN { FS=" " } { print $2 }' data/search_ssh.txt)

#loop over the vulnerabilities
#check if it is auxiliary or an exploit
#if auxiliary then call show options
#if exploit then call show exploits

for arg in $vulnerabilities
do
aux_or_exploit=$(echo $arg |awk 'BEGIN { FS="/" } { print $1 }')

#check if it is auxiliary or an exploit
if [ $aux_or_exploit == "auxiliary" ]
then

name=$(echo $arg |awk 'BEGIN { FS="/" } { print $4 }')
if [$name == "ssh_login"]
then
#if auxiliary then call show options
sudo /bin/bash <<begin_to_end
./5_aux_exploit.sh
begin_to_end
fi
else

#if exploit then call show exploits
sudo /bin/bash <<begin_to_end
echo "$aux_or_exploit is not supported as of now"
begin_to_end
fi
done
